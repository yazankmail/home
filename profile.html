<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø­Ø³Ø§Ø¨ÙŠ - Wusooly</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cairo:wght@400;600;700&display=swap');
        
        :root {
            --bg-color: #f8f9fa; --text-color: #333; --text-secondary: #666;
            --header-bg: #ffffff; --card-bg: #ffffff; --border-color: #eee;
            --icon-color: #333; --input-bg: #f9f9f9; --shadow-color: rgba(0,0,0,0.05);
            --nav-active: #ff4747; --btn-danger: #ff4747;
        }

        body.dark-mode {
            --bg-color: #121212; --text-color: #e0e0e0; --text-secondary: #aaa;
            --header-bg: #1e1e1e; --card-bg: #1e1e1e; --border-color: #333;
            --icon-color: #fff; --input-bg: #2c2c2c; --shadow-color: rgba(0,0,0,0.3);
        }

        * { box-sizing: border-box; transition: background-color 0.3s, color 0.3s; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Cairo', 'Inter', sans-serif; margin: 0; background-color: var(--bg-color); color: var(--text-color); padding-bottom: 80px; overflow-x: hidden; }
        a { text-decoration: none; color: var(--text-color); }

        /* --- Header --- */
        header { background-color: var(--header-bg); box-shadow: 0 1px 5px var(--shadow-color); position: sticky; top: 0; z-index: 1000; height: 60px; display: flex; align-items: center; justify-content: center; }
        .logo-img { height: 26px; width: auto; object-fit: contain; }

        /* --- Profile Section --- */
        .container { max-width: 600px; margin: 20px auto; padding: 0 20px; text-align: center; }
        
        .profile-card {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 40px 20px;
            box-shadow: 0 5px 20px var(--shadow-color);
            margin-top: 50px;
            border: 1px solid var(--border-color);
        }

        .profile-img {
            width: 100px; height: 100px;
            border-radius: 50%;
            background-color: var(--input-bg);
            margin: 0 auto 20px;
            display: block;
            object-fit: cover;
            border: 3px solid var(--border-color);
        }

        .user-name { font-size: 22px; font-weight: bold; margin-bottom: 5px; }
        .user-email { font-size: 14px; color: var(--text-secondary); margin-bottom: 30px; }

        .btn-logout {
            background-color: var(--input-bg);
            color: var(--btn-danger);
            border: 1px solid var(--border-color);
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            justify-content: center;
        }
        .btn-logout:active { transform: scale(0.98); }

        /* --- Bottom Nav --- */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--header-bg); display: flex; justify-content: space-around; align-items: center; padding: 10px 0; box-shadow: 0 -2px 10px var(--shadow-color); z-index: 999; border-top: 1px solid var(--border-color); }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-secondary); text-decoration: none; font-size: 11px; gap: 4px; cursor: pointer; width: 25%; }
        .nav-item.active { color: var(--nav-active); font-weight: bold; }
        .nav-item svg { width: 24px; height: 24px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        
        /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± */
        @media (min-width: 769px) { .bottom-nav { display: none; } }

    </style>
</head>
<body>

    <header>
        <a href="index.html">
            <img id="app-logo" src="https://i.ibb.co/4R8nMfcs/image.png" alt="Wusooly Logo" class="logo-img">
        </a>
    </header>

    <div class="container">
        <div id="loading" style="margin-top: 50px; color: var(--text-secondary);">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

        <div id="user-profile" class="profile-card" style="display: none;">
            <img id="user-img" src="" alt="Profile" class="profile-img">
            <div id="user-name" class="user-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</div>
            <div id="user-email" class="user-email">email@example.com</div>
            
            <button class="btn-logout" onclick="logout()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            </button>
        </div>

        <div id="guest-profile" class="profile-card" style="display: none;">
            <div style="font-size: 50px; margin-bottom: 20px;">ğŸ‘¤</div>
            <h2 style="margin: 0 0 10px;">Ø£Ù†Øª ØºÙŠØ± Ù…Ø³Ø¬Ù„</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ</p>
            <a href="index.html" class="btn-logout" style="background: #1c1c1e; color: white; text-decoration: none;">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªØ³Ø¬ÙŠÙ„</a>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active"> <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
            <span>Ø§Ù„Ø­Ø³Ø§Ø¨</span>
        </div>
        <a href="cart.html" class="nav-item">
            <svg viewBox="0 0 24 24"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
            <span>Ø§Ù„Ø¹Ø±Ø¨Ø©</span>
        </a>
        <a href="index.html" class="nav-item">
            <svg viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
            <span>Ø§Ù„ÙØ¦Ø©</span>
        </a>
        <a href="index.html" class="nav-item">
            <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
            <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </a>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ
        const firebaseConfig = {
            apiKey: "AIzaSyBa0RwEcbVqWYAKeUFeZy2IDihaxUxtNKY",
            authDomain: "wusooly-1906b.firebaseapp.com",
            projectId: "wusooly-1906b",
            storageBucket: "wusooly-1906b.firebasestorage.app",
            messagingSenderId: "95836343161",
            appId: "1:95836343161:web:73ae3faaca406c0bf7fda8",
            measurementId: "G-2704R4YR1M"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ (Ù†ÙØ³ Ù…Ù†Ø·Ù‚ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)
        const lightLogoUrl = "https://i.ibb.co/4R8nMfcs/image.png";
        const darkLogoUrl = "https://i.ibb.co/k6QxrwjQ/image.png";
        const logoImg = document.getElementById('app-logo');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');

        function applyTheme(isDark) {
            if (isDark) { document.body.classList.add('dark-mode'); logoImg.src = darkLogoUrl; }
            else { document.body.classList.remove('dark-mode'); logoImg.src = lightLogoUrl; }
        }
        applyTheme(systemPrefersDark.matches);
        systemPrefersDark.addEventListener('change', (e) => { applyTheme(e.matches); });

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        onAuthStateChanged(auth, (user) => {
            document.getElementById('loading').style.display = 'none';
            if (user) {
                // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
                document.getElementById('user-profile').style.display = 'block';
                document.getElementById('guest-profile').style.display = 'none';
                
                document.getElementById('user-name').innerText = user.displayName;
                document.getElementById('user-email').innerText = user.email;
                if(user.photoURL) document.getElementById('user-img').src = user.photoURL;
                else document.getElementById('user-img').src = "https://via.placeholder.com/100";
            } else {
                // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„
                document.getElementById('user-profile').style.display = 'none';
                document.getElementById('guest-profile').style.display = 'block';
            }
        });

        // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        window.logout = function() {
            signOut(auth).then(() => {
                window.location.href = "index.html";
            }).catch((error) => {
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø®Ø±ÙˆØ¬");
            });
        }
    </script>
</body>
</html>